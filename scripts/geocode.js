document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("geocode-form");let n=document.getElementById("keyword-input"),o=document.getElementById("geocode-result");function r(e){return console.log("取得したgeocode:",e),e}function t(e){o.innerHTML=`<p class="error">${e}</p>`}e&&e.addEventListener("submit",function(e){e.preventDefault();e=n.value;e?fetch("/geocode?keyword="+encodeURIComponent(e)).then(e=>{if(e.ok)return e.json();throw new Error("ネットワークレスポンスが正常ではありません")}).then(e=>{if(console.log("APIからのレスポンス:",e),e.error)throw new Error(e.error);return e.geocode}).then(r).then(e=>{var n=e;return n=encodeURIComponent(e),fetch("/searchLibrary?geocode="+n).then(e=>{if(e.ok)return e.json();throw new Error("図書館データの取得に失敗しました")}).then(e=>{console.log("Library Search Results:",e);{o.innerHTML="";let r=document.createElement("div");r.innerHTML="<h3>近くの図書館</h3>",e.forEach(e=>{var n=document.createElement("div");n.innerHTML=`
                <p>名前: ${e.formal}</p>
                <p>住所: ${e.address}</p>
            `,r.appendChild(n)}),o.appendChild(r)}}).catch(e=>{console.error("Library search failed:",e),t("図書館データの取得に失敗しました")})}).catch(t):t("キーワードを入力してください。")})});